<code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Only&nbsp;production&nbsp;environments&nbsp;will&nbsp;have&nbsp;this&nbsp;set&nbsp;â€“&nbsp;turning&nbsp;on&nbsp;sandboxing<br />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;DEP_VERSION&nbsp;is&nbsp;for&nbsp;cloud&nbsp;control<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$sandbox_me&nbsp;</span><span style="color: #007700">=&nbsp;isset(</span><span style="color: #0000BB">$_ENV</span><span style="color: #007700">[</span><span style="color: #DD0000">'PHPEPL_PROD'</span><span style="color: #007700">])&nbsp;||&nbsp;isset(</span><span style="color: #0000BB">$_ENV</span><span style="color: #007700">[</span><span style="color: #DD0000">'DEP_VERSION'</span><span style="color: #007700">]);<br />&nbsp;&nbsp;&nbsp;&nbsp;require_once(</span><span style="color: #DD0000">'../vendor/autoload.php'</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Turn&nbsp;off&nbsp;errors&nbsp;since&nbsp;eval&nbsp;will&nbsp;throw&nbsp;them&nbsp;on&nbsp;invalid&nbsp;syntax<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">@</span><span style="color: #0000BB">ini_set</span><span style="color: #007700">(</span><span style="color: #DD0000">'log_errors'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;@</span><span style="color: #0000BB">ini_set</span><span style="color: #007700">(</span><span style="color: #DD0000">'display_errors'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//set&nbsp;time&nbsp;limit&nbsp;to&nbsp;avoid&nbsp;long-running&nbsp;scripts&nbsp;killing&nbsp;our&nbsp;server&nbsp;process<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">set_time_limit</span><span style="color: #007700">(</span><span style="color: #0000BB">1</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;CORS&nbsp;support<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">"Access-Control-Allow-Origin:&nbsp;*"</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">"Content-type:&nbsp;application/json"</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;No&nbsp;need&nbsp;for&nbsp;the&nbsp;open&nbsp;and&nbsp;close&nbsp;php&nbsp;tags<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$toRemove&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">"&lt;?php"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"?&gt;"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"&lt;?"</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$code&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$toRemove</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">""</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'code'</span><span style="color: #007700">]);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Brilliant&nbsp;method&nbsp;for&nbsp;even&nbsp;catching&nbsp;fatal_errors<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">register_shutdown_function</span><span style="color: #007700">(</span><span style="color: #DD0000">"on_script_finish"</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Output&nbsp;buffering&nbsp;to&nbsp;catch&nbsp;the&nbsp;results&nbsp;and&nbsp;errors<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">ob_start</span><span style="color: #007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">$sandbox_me</span><span style="color: #007700">?&nbsp;</span><span style="color: #0000BB">php_execute_sandboxed</span><span style="color: #007700">(</span><span style="color: #0000BB">$code</span><span style="color: #007700">):</span><span style="color: #0000BB">php_execute_raw</span><span style="color: #007700">(</span><span style="color: #0000BB">$code</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;output&nbsp;is&nbsp;captured&nbsp;in&nbsp;on_script_finished&nbsp;as&nbsp;script&nbsp;shuts&nbsp;down<br />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;END&nbsp;MAIN<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Handler&nbsp;that&nbsp;executes&nbsp;on&nbsp;script&nbsp;completion<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">on_script_finish</span><span style="color: #007700">()&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;http://stackoverflow.com/a/2146171/700897<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$result&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">ob_get_clean</span><span style="color: #007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$error&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">error_get_last</span><span style="color: #007700">();<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">json_encode</span><span style="color: #007700">(array(</span><span style="color: #DD0000">"result"&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$result</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"error"&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$error</span><span style="color: #007700">));<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;</span><span style="color: #0000BB">php_execute_sandboxed</span><span style="color: #007700">(</span><span style="color: #0000BB">$code</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Blacklist<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$blackList&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">"phpinfo"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"file_get_contents"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"exec"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"passthru"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"system"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"shell_exec"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"`"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"popen"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"proc_open"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"pcntl_exec"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"eval"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"assert"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"create_function"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"include"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"include_once"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"require"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"require_once"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"ReflectionFunction"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"posix_mkfifo"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"posix_getlogin"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"posix_ttyname"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"getenv"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"get_current_user"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"proc_get_status"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"get_cfg_var"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"disk_free_space"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"disk_total_space"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"diskfreespace"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"getcwd"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"getlastmo"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"getmygid"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"getmyinode"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"getmypid"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"getmyuid"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"extract"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"parse_str"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"putenv"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"ini_set"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"mail"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"header"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"proc_nice"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"proc_terminate"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"proc_close"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"pfsockopen"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"fsockopen"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"apache_child_terminate"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"posix_kill"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"posix_mkfifo"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"posix_setpgid"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"posix_setsid"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"posix_setuid"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"fopen"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"tmpfile"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"bzopen"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"gzopen"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"SplFileObject"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"chgrp"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"chmod"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"chown"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"copy"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"file_put_contents"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"lchgrp"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"lchown"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"link"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"mkdir"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"move_uploaded_file"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"rename"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"rmdir"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"symlink"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"tempnam"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"touch"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"unlink"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"imagepng"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"imagewbmp"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"image2wbmp"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"imagejpeg"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"imagexbm"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"imagegif"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"imagegd"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"imagegd2"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"iptcembed"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"ftp_get"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"ftp_nb_get"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"file_exists"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"file_get_contents"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"file"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"fileatime"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"filectime"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"filegroup"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"fileinode"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"filemtime"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"fileowner"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"fileperms"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"filesize"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"filetype"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"glob"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"is_dir"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"is_executable"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"is_file"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"is_link"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"is_readable"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"is_uploaded_file"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"is_writable"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"is_writeable"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"linkinfo"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"lstat"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"parse_ini_file"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"pathinfo"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"readfile"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"readlink"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"realpath"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"stat"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"gzfile"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"readgzfile"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"getimagesize"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"imagecreatefromgif"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"imagecreatefromjpeg"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"imagecreatefrompng"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"imagecreatefromwbmp"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"imagecreatefromxbm"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"imagecreatefromxpm"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"ftp_put"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"ftp_nb_put"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"exif_read_data"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"read_exif_data"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"exif_thumbnail"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"exif_imagetype"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"hash_file"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"hash_hmac_file"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"hash_update_file"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"md5_file"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"sha1_file"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"highlight_file"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"show_source"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"php_strip_whitespace"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"get_meta_tags"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"set_time_limit"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"call_user_func"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"call_user_func_array"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"php_execute_raw"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'Composer\Autoload\includeFile'<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$whiteList&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'print_r'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'preg_match'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'preg_replace'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'preg_match_all'</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$sandbox&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;\</span><span style="color: #0000BB">PHPSandbox</span><span style="color: #007700">\</span><span style="color: #0000BB">PHPSandbox</span><span style="color: #007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$sandbox</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">blacklist_func</span><span style="color: #007700">(</span><span style="color: #0000BB">$blackList</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;$sandbox-&gt;whitelist_func($whiteList);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$sandbox</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">allow_functions&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$sandbox</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">allow_closures&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$sandbox</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">allow_constants&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$sandbox</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">allow_aliases&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$sandbox</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">allow_interfaces&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$sandbox</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">allow_casting&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$sandbox</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">allow_classes&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$sandbox</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">error_level&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//rewrite&nbsp;preg_replace&nbsp;function&nbsp;to&nbsp;override&nbsp;attempts&nbsp;to&nbsp;use&nbsp;PREG_REPLACE_EVAL<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$sandbox</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">define_func</span><span style="color: #007700">(</span><span style="color: #DD0000">'preg_replace'</span><span style="color: #007700">,&nbsp;function(</span><span style="color: #0000BB">$pattern</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$replacement</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$subject</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$limit&nbsp;</span><span style="color: #007700">=&nbsp;-</span><span style="color: #0000BB">1</span><span style="color: #007700">,&nbsp;&amp;</span><span style="color: #0000BB">$count&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">is_array</span><span style="color: #007700">(</span><span style="color: #0000BB">$pattern</span><span style="color: #007700">)){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach(</span><span style="color: #0000BB">$pattern&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$_pattern</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strtolower</span><span style="color: #007700">(</span><span style="color: #0000BB">substr</span><span style="color: #007700">(</span><span style="color: #0000BB">$_pattern</span><span style="color: #007700">,&nbsp;-</span><span style="color: #0000BB">1</span><span style="color: #007700">))&nbsp;==&nbsp;</span><span style="color: #DD0000">'e'</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;</span><span style="color: #0000BB">Exception</span><span style="color: #007700">(</span><span style="color: #DD0000">"Can&nbsp;not&nbsp;use&nbsp;PREG_REPLACE_EVAL!"</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if(</span><span style="color: #0000BB">strtolower</span><span style="color: #007700">(</span><span style="color: #0000BB">substr</span><span style="color: #007700">(</span><span style="color: #0000BB">$pattern</span><span style="color: #007700">,&nbsp;-</span><span style="color: #0000BB">1</span><span style="color: #007700">))&nbsp;==&nbsp;</span><span style="color: #DD0000">'e'</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;</span><span style="color: #0000BB">Exception</span><span style="color: #007700">(</span><span style="color: #DD0000">"Can&nbsp;not&nbsp;use&nbsp;PREG_REPLACE_EVAL!"</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">preg_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$pattern</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$replacement</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$subject</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$limit</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$count</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$sandbox</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$code</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;</span><span style="color: #0000BB">php_execute_raw</span><span style="color: #007700">(</span><span style="color: #0000BB">$code</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eval(</span><span style="color: #0000BB">$code</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /></span>
</span>
</code>